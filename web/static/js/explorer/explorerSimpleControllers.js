var immeubleApp=angular.module("immeubleApp");immeubleApp.controller("home",function(a,f,e,d){a.projet={imageURL:"static/framework/images/wait.gif"};d.getProjet(null,function(d){a.projet=d;e(function(){a.$apply()},1)});jQuery(function(){immeubleApp.adjestWidthHeightFenetreHandler();$(window).resize(function(){immeubleApp.adjestWidthHeightFenetreHandler()})})});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("ImageGalleryController",function(a,f,e,d){function h(){return setInterval(function(){a.droite()},4E3)}a.images=[];a.isEncours=!1;jQuery(function(){a.interval=h()});a.droite=function(){if(!a.isEncours){a.isEncours=!0;var c=$(".fenetreDimension").css("width").replace("px",""),c=parseInt(c),b=$("div#imagesAffichage ul li:first-child"),g=$("div#imagesAffichage ul");$(g).animate({left:"-"+c},2E3,function(){$(g).append(b);$(g).css("left","0px");a.isEncours=!1})}};a.gauche=function(){if(!a.isEncours){a.isEncours=
!0;clearInterval(a.interval);var c=$(".fenetreDimension").css("width").replace("px",""),c=parseInt(c);clearInterval(a.interval);var b=$("div#imagesAffichage ul li:last-child"),g=$("div#imagesAffichage ul");$(g).prepend(b);$(g).css("left","-"+c+"px");$(g).animate({left:"0px"},2E3,function(){a.isEncours=!1;a.interval=h()})}};a.getImagesPanorama=function(){if(0==a.images.length)d.getProjet(null,function(c){a.images=c.diaporamas;e(function(){a.$apply();immeubleApp.adjestWidthHeightFenetreHandler()},1)});
else return a.images}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("ListerProjet",function(a,f,e,d,h,c){function b(){h.getProjets(c.page,function(b){a.projets=b;e(function(){a.$apply()},1)})}a.projets=[];a.projetRechercher="";a.getURL=function(a){return f.protocol()+"://"+f.host()+immeubleApp.urlProjetSimple+a.id};a.previous=function(){if(1!==parseInt(c.page)){var a=parseInt(c.page)-1;e(function(){f.path("/lister/"+a)},1)}};a.next=function(){var a=parseInt(c.page)+1;e(function(){f.path("/lister/"+a)},1)};a.$watch("projetRechercher",function(g){""===
g?b():h.rechercherProjets(g,function(b){a.projets=b;e(function(){a.$apply()},1)})});b();a.modifier=function(a){e(function(){f.path("/modifier/"+a.id)},1)};a.remove=function(a){immeubleApp.openWarningDialog(d,"\u00eates-vous s\u00fbre de supprimer le projet "+a.nom,function(){h.removeProjet(a.id,function(){b()},function(){immeubleApp.openErrorDialog("erreur lors de connection veuillez v\u00e9rifier votre connection","erreur de connection")})},function(){})}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("modifierProjet",function(a,f,e,d,h){function c(){d.getProjet(h.id,function(b){var g=a.projet.imageDiaporamas,c=a.projet.planVente;a.projet=b;a.oldProjet=jQuery.extend({},b);a.projet.imageDiaporamas=g;a.projet.planVente=c;e(function(){a.$apply()},1)},!0)}a.projet={imageDiaporamas:[],color:"#009aff"};a.form=new FormData;$("#colorProjet input[type=file]").change(function(){immeubleApp.openDialog("#choisirColor-dialog");var a=$("#choisirColor-dialog");a.css("width",$(window).width()+
"px");a.css("height",$(window).height()-20+"px")});a.choisirColor=function(b){var c=b.offsetX;b=b.offsetY;var k=document.createElement("canvas"),d=k.getContext("2d"),e=$("#imageChoisirColor").width(),f=$("#imageChoisirColor").height();k.width=e;k.height=f;k=new Image(e,f);k.src=a.projet.imageColorURL;d.drawImage(k,0,0,e,f);e=d.getImageData(c,b,1,1).data;c=a.oldProjet;b=e[0];d=e[1];e=e[2];if(255<b||255<d||255<e)throw"Invalid color component";b=(b<<16|d<<8|e).toString(16);c.color="#"+b;immeubleApp.closeDialog()};
a.closeDialog=function(){immeubleApp.closeDialog()};c();a.havePlanVente=function(){return void 0!==a.projet.planVente};a.haveVisiteVirtuelle=function(){return void 0!==a.projet.vv};a.isEncours=!1;a.removeDiaporama=function(b){d.removeProjetDiaporama(a.projet.id,b,function(){c()})};$("myfile[form=projet_diaporamas] input[type=file]").change(function(){d.removeProjetAllDiaporama(a.projet.id,function(){c()})});$(".AddImageDiapo button").click(function(){$(".AddImageDiapo input[type=file]").click()});
a.addImageDiapo=function(b){b=b.files;for(var c=a.form.get("projet_diaporamasNB"),c=null===c?0:parseInt(c),d=0;d<b.length;d++)a.form.set("projet_diaporamas["+(d+c)+"]",b[d]),a.projet.imageDiaporamas[d+c]=immeubleApp.createURL(b[d]);a.form.set("projet_diaporamasNB",c+b.length);e(function(){a.$apply()},1)};a.removeImageDiaporama=function(b){var c=a.projet.imageDiaporamas.length,d=a.form;d.get("projet_diaporamasNB");-1<b&&a.projet.imageDiaporamas.splice(b,1);d["delete"]("projet_diaporamas["+b+"]");for(b+=
1;b<c;b++){var f=d.get("projet_diaporamas["+b+"]");d.set("projet_diaporamas["+(b-1)+"]",f);d["delete"]("projet_diaporamas["+b+"]")}d.set("projet_diaporamasNB",c-1);e(function(){a.$apply()},1)};a.verifierFormulaireAjout=function(b,c){void 0!==a.projet.nom&&a.projet.nom.match("^[a-zA-Z1-9 ]{2,100}$")?(jQuery($('[ng-model="oldProjet.nom"]').removeClass("input-invalid")),a.oldProjet.nom!==a.projet.nom?d.isProjetExist(a.oldProjet.nom,function(){jQuery($('[ng-model="oldProjet.nom"]').addClass("input-invalid"));
c()},function(){jQuery($('[ng-model="oldProjet.nom"]').removeClass("input-invalid"));b()},function(){immeubleApp.openErrorDialog("La connexion a \u00e9chou\u00e9 v\u00e9rifier votre connection","Error de connexion");c()}):b()):(jQuery($('[ng-model="oldProjet.nom"]').addClass("input-invalid")),c())};a.valider=function(){if(!a.isEncours){a.isEncours=!0;var b=$("#progressbar");a.verifierFormulaireAjout(function(){d.modifierProjet(a.oldProjet,a.form,function(){immeubleApp.openInformationDialog("Le Projet a \u00e9t\u00e9 ajouter avec succ\u00e9s",
"Ajouter Projet");a.isEncours=!1;setTimeout(function(){location.reload()},2E3)},function(){immeubleApp.openErrorDialog("le projet n'a pas \u00e9t\u00e9 ajouter v\u00e9rifier votre connection","Error de connection");a.isEncours=!1},function(a){b.css("width",a+"%")})},function(){a.isEncours=!1})}}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("TabsController",function(a,f,e,d){function h(a){var b=$("<style type='text/css'></style>");b.text("ul#bar{ background-color : "+a+"}ul#tabs-ul{border-bottom-color:"+a+"}ul#tabs-ul li.current:hover{background-color : "+a+"}ul#tabs-ul li.current{background-color : "+a+"}#informationPane table thead th{background-color : "+a+"}");$("head").append(b)}a.isActive=function(a){var b=f.path();if(a===b)return!0};a.choise=function(a,b){d(function(){f.path(a);setTimeout(function(){immeubleApp.adjestWidthHeightFenetreHandler()},
200)},1)};a.init=function(c){e.getProjet(c,function(b){a.projet=b;h(a.projet.color);d(function(){a.$apply()},2)})};jQuery(function(){immeubleApp.adjestWidthHeightFenetreHandler();$(window).resize(function(){immeubleApp.adjestWidthHeightFenetreHandler()})})});immeubleApp=angular.module("immeubleApp");immeubleApp.controller("vvSimpleController",function(a){a.init=function(a){embedpano({swf:a,target:"vv",passQueryParameters:!0,wmode:"opaque"})}});