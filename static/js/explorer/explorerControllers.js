var immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("appartement",function(a,l,k,h,f){a.appartement={id:h.id};a.isShow=!1;f.getAppartement(a.appartement.id,function(d){a.appartement=d;k(function(){a.$apply()},1)});a.haveFlash=function(){return""!=a.appartement.flashURL};a.showFlash=function(){a.isShow=!0;embedpano({swf:"/static/projets/complet/"+a.projet.nom+a.appartement.flashURL,target:"vv",passQueryParameters:!0,wmode:"opaque"});immeubleApp.adjestWidthHeightFenetreHandler()};a.showTable=!1;a.topButtonHandler=function(){a.showTable=
!a.showTable}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("draw",function(a,l,k,h,f,d){a.index=100;a.StringToPoints=function(a){var e=[];if(""===a)return e;var c=0;a=a.split(" ");for(var d=0;d<a.length;d++){var g=a[d].split(",");e[c]={x:parseFloat(g[0]),y:parseFloat(g[1])};c++}return e};a.pointsToString=function(a){var e="",c=!0;a.forEach(function(a){c?(e=a.x+","+a.y,c=!1):e=e+" "+a.x+","+a.y});return e};a.isDrawing=!0;a.drawPolygone={image:"",points:[],oldChild:null,obj:null};a.undoPoints=[];a.drawPolygone.image=h;a.drawPolygone.points=
a.StringToPoints(f.points_polygone);a.drawPolygone.obj=f;a.autrePolygone=[];for(var c=h=0,c=0;c<d.length;c++){var g=d[c];f!==g&&(a.autrePolygone[h]=a.StringToPoints(g.points_polygone),h++)}immeubleApp.apply(a,l);setTimeout(function(){$("#drawContainer-div").focus()},1E3);a.ajouterPointAutre=function(b,e){b.stopPropagation();a.drawPolygone.points[a.drawPolygone.points.length]={x:e.x,y:e.y}};a.mouseDown=function(b,e){b.preventDefault();if(2!==b.button){var c=b.currentTarget;a.isMouseDown=!0;$(c).mousemove(function(b){parseFloat($(".zoom").css("zoom"));
var c=b.offsetY;e.x=b.offsetX;e.y=c;immeubleApp.apply(a,l)});$(c).mouseup(function(a){a.preventDefault();$(c).off("mousemove")});$(c).mouseleave(function(a){a.preventDefault();$(c).off("mousemove")})}};$("#canvas").bind("mousewheel",function(b){a.isDrawing&&4===b.originalEvent.buttons&&(0<b.originalEvent.wheelDelta/120?(b=parseFloat($(".zoom").css("zoom")),immeubleApp.changeZoom($(".zoom"),b+.1)):(b=parseFloat($(".zoom").css("zoom")),immeubleApp.changeZoom($(".zoom"),b-.1)))});$(document).keypress(function(b){if(a.isDrawing)if(122===
b.which){if(b=a.drawPolygone.points.length,-1<b){var e=a.undoPoints.length;a.undoPoints[e]=a.drawPolygone.points[b-1];a.drawPolygone.points.splice(b-1,1);immeubleApp.apply(a,l)}}else 113===b.which?(b=parseFloat($(".zoom").css("zoom")),immeubleApp.changeZoom($(".zoom"),b-.1)):97===b.which?(b=parseFloat($(".zoom").css("zoom")),immeubleApp.changeZoom($(".zoom"),b+.1)):121===b.which&&(b=a.drawPolygone.points.length,e=a.undoPoints.length,0<e&&(a.drawPolygone.points[b]=a.undoPoints[e-1],a.undoPoints.splice(e-
1,1),immeubleApp.apply(a,l)))});a.isMouseDown=!1;a.clickCanvas=function(b){if(a.isMouseDown)a.isMouseDown=!1;else{a.undoPoints=[];$(b).offset();var e=parseFloat($(".zoom").css("zoom"));a.drawPolygone.points[a.drawPolygone.points.length]={x:b.offsetX/e,y:b.offsetY/e};immeubleApp.apply(a,l)}};a.validerDraw=function(){a.isDrawing=!1;k.close(a.pointsToString(a.drawPolygone.points))};a.cancel=function(){k.dismiss("cancel")}});immeubleApp=angular.module("immeubleApp");immeubleApp.controller("envoyerEmail",function(a,l){a.promoteur={};a.error=[];a.ok=function(){void 0!==a.promoteur.nom&&a.promoteur.nom.match("^[a-zA-Z1-9 ]{2,100}$")?(a.error[1]=!1,void 0!==a.promoteur.nomProjet&&a.promoteur.nomProjet.match("^[a-zA-Z1-9 ]{2,100}$")?(a.error[0]=!1,l.close(a.promoteur)):a.error[0]=!0):a.error[1]=!0};a.cancel=function(){l.dismiss("cancel")}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("etage",function(a,l,k,h,f,d){a.etage={id:f.id};a.isShow=!1;d.getEtage(a.etage.id,function(c){a.etage=c;immeubleApp.apply(a,k)});a.openDescriptionApp=function(a,d,b){var e=$("#descriptionAppartementDialog");$(e).find(".numeroApp").html(a.numero);$(e).find(".nbChambreApp").html(a.nbChambre);$(e).find(".etageApp").html(a.etage);$(e).find(".superficieApp").html(h("number")(a.superficie,0)+" m\u00b2");$(e).find(".prixApp").html(h("number")(a.prix,2)+" DH");$(e).find(".disponibleApp").html(a.disponibilite);
$(e).find(".disponibleApp").removeClass("r\u00e9serv\u00e9e");$(e).find(".disponibleApp").removeClass("vendu");$(e).find(".disponibleApp").removeClass("disponible");$(e).find(".disponibleApp").removeClass("non");$(e).find(".disponibleApp").addClass(a.disponibilite);a=parseFloat($(".fenetreDimension").css("height").replace("px",""));var m=$(e).height();b+m>a&&(b=b-m-30);$(e).css("top",b+"px");$(e).css("left",d+"px");$(e).css("display","block")};a.closeDescriptionApp=function(){var a=$("#descriptionAppartementDialog");
$(a).css("display","none")};a.getAppartement=function(c){for(var d=a.etage.appartements,b=0;b<d.length;b++)if(d[b].id===c)return d[b]};jQuery(function(){$("img").load(function(){null===localStorage.getItem("newClient")?(localStorage.setItem("newClient",!0),$("#svg polygon").addClass("polygone-polygon"),$("#reminder").css("display","block"),setTimeout(function(){$(".polygone-polygon").removeClass("polygone-polygon");$("#reminder").css("display","none")},3E3)):($("#svg polygon").addClass("polygone-polygon"),
setTimeout(function(){$(".polygone-polygon").removeClass("polygone-polygon")},1E3))})});a.isReservee=function(a){return"r\u00e9serv\u00e9e"===a.disponibilite};a.hover=function(c,d){a.openDescriptionApp(a.getAppartement(c),d.pageX-50,d.pageY+15)};a.mouseoverTdHandler=function(a){$("svg polygon#"+a).addClass("polygone-polygon")};a.mouseoutTdHandler=function(a){$("svg polygon#"+a).removeClass("polygone-polygon")};a.out=function(){a.closeDescriptionApp()};a.goToAppartement=function(c){a.go("appartement/"+
c)};a.goToEtage=function(c){a.go("etage/"+c)};a.go=function(c){a.out();immeubleApp.go(l,k,c)};a.showTable=!1;a.topButtonHandler=function(){a.showTable=!a.showTable}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("gererAppartements",function(a,l,k,h,f,d,c,g,b,e,m,n){a.index=10;d.avoirEtageComposition?void 0===b.appartements&&(b.appartements=[]):void 0===d.appartements&&(d.appartements=[]);a.nombreAppartement=1;a.numero=c;a.immeuble=d;a.form=g;a.etage=b;a.indiceImmeuble=e;a.indiceEtage=m;a.nomProjet=n;a.getAppartements=function(){return a.immeuble.avoirEtageComposition?a.etage.appartements:a.immeuble.appartements};a.openDrawPolygoneAppartement=function(b){if(a.immeuble.avoirEtageComposition)var e=
void 0!==a.etage.image?a.etage.image:"/static/projets/complet/"+a.nomProjet+a.etage.imageURL,c=a.etage.appartements;else e=void 0!==a.immeuble.image?a.immeuble.image:"/static/projets/complet/"+a.nomProjet+a.immeuble.imageURL,c=a.immeuble.appartements;h.open({animation:!0,templateUrl:"/static/framework/template/drawDialog.html",controller:"draw",size:"lg",resolve:{image:function(){return e},obj:function(){return b},autreObjs:function(){return c}}}).result.then(function(a){b.points_polygone=a},function(){})};
a.ajouterAppartementButtonHandler=function(){var b;if(a.immeuble.avoirEtageComposition){b=a.etage.appartements.length;for(var e=0;e<a.nombreAppartement;e++)a.etage.appartements[b+e]={disponibilite:"disponible",points_polygone:"",etage:a.etage.numero,numero:a.numero},a.numero++}else for(b=a.immeuble.appartements.length,e=0;e<a.nombreAppartement;e++)a.immeuble.appartements[b+e]={disponibilite:"disponible",points_polygone:"",numero:a.numero},a.numero++;immeubleApp.apply(a,l)};a.removeAppartement=function(b){var e=
a.immeuble.avoirEtageComposition?a.etage.appartements[b]:a.immeuble.appartements[b];void 0!==e.id?k.removeAppartement(a.projet.id,e.id,function(){a.immeubleChoisir.appartements.splice(b,1);immeubleApp.apply(a,l)}):(a.immeuble.appartements.splice(b,1),immeubleApp.apply(a,l));if(a.immeuble.avoirEtageComposition){e=a.etage.appartements.length;a.form["delete"]("appartement_planVente["+a.indiceImmeuble+"]["+a.indiceEtage+"]["+b+"]");a.form["delete"]("appartement_vv["+a.indiceImmeuble+"]["+a.indiceEtage+
"]["+b+"]");for(var c=b+1;c<e;c++){var d=a.form.get("appartement_planVente["+a.indiceImmeuble+"]["+a.indiceEtage+"]["+c+"]"),m=a.form.get("appartement_vv["+a.indiceImmeuble+"]["+a.indiceEtage+"]["+c+"]");a.form.set("appartement_planVente["+a.indiceImmeuble+"]["+a.indiceEtage+"]["+(c-1)+"]",d);a.form.set("appartement_vv["+a.indiceImmeuble+"]["+a.indiceEtage+"]["+(c-1)+"]",m);a.form["delete"]("appartement_planVente["+a.indiceImmeuble+"]["+a.indiceEtage+"]["+c+"]");a.form["delete"]("appartement_vv["+
a.indiceImmeuble+"]["+a.indiceEtage+"]["+c+"]")}}else for(e=a.immeuble.appartements.length,a.form["delete"]("appartement_planVente["+a.indiceImmeuble+"]["+b+"]"),a.form["delete"]("appartement_vv["+a.indiceImmeuble+"]["+b+"]"),c=b+1;c<e;c++)d=a.form.get("appartement_planVente["+a.indiceImmeuble+"]["+c+"]"),m=a.form.get("appartement_vv["+a.indiceImmeuble+"]["+c+"]"),a.form.set("appartement_planVente["+a.indiceImmeuble+"]["+(c-1)+"]",d),a.form.set("appartement_vv["+a.indiceImmeuble+"]["+(c-1)+"]",m),
a.form["delete"]("appartement_planVente["+a.indiceImmeuble+"]["+c+"]"),a.form["delete"]("appartement_vv["+a.indiceImmeuble+"]["+c+"]")};a.valider=function(){f.close()};a.cancel=function(){f.dismiss("cancel")}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("gererEtages",function(a,l,k,h,f,d,c,g,b){void 0===d.etages&&(d.etages=[]);a.immeuble=d;a.form=c;a.indiceImmeuble=g;a.nombreEtagesAjouter=1;a.nomProjet=b;a.numero=1;a.gererAppartement=function(b){var c=b.appartements.length,d=0===c?1:b.appartements[c-1].numero+1;h.open({animation:!0,templateUrl:"/static/framework/template/gererAppartements.html",controller:"gererAppartements",size:"grand",resolve:{numero:function(){return d},immeuble:function(){return a.immeuble},form:function(){return a.form},
etage:function(){return b},indiceImmeuble:function(){return a.indiceImmeuble},indiceEtage:function(){return a.immeuble.etages.indexOf(b)},nomProjet:function(){return a.nomProjet}}})};a.openDrawPolygoneEtage=function(b){var c=void 0!==a.immeuble.image?a.immeuble.image:"/static/projets/complet/"+a.nomProjet+a.immeuble.imageURL;h.open({animation:!0,templateUrl:"/static/framework/template/drawDialog.html",controller:"draw",size:"lg",resolve:{image:function(){return c},obj:function(){return b},autreObjs:function(){return a.immeuble.etages}}}).result.then(function(a){b.points_polygone=
a},function(){})};a.ajouterEtagesButtonHandler=function(){for(var b=a.immeuble.etages.length,c=0;c<a.nombreEtagesAjouter;c++)a.immeuble.etages[b+c]={points_polygone:"",numero:a.numero,appartements:[]},a.numero++;immeubleApp.apply(a,l)};a.removeEtage=function(b){var c=a.immeuble.etages[b];if(void 0!==c.id)k.removeEtage(c.id,function(){a.immeuble.etages.splice(b,1);immeubleApp.apply(a,l)});else{a.immeuble.etages.splice(b,1);immeubleApp.apply(a,l);c=a.immeuble.etages.length;a.form["delete"]("etage_image["+
a.indiceImmeuble+"]["+b+"]");for(var d=b+1;d<c;d++){var g=a.form.get("etage_image["+a.indiceImmeuble+"]["+d+"]");a.form.set("etage_image["+a.indiceImmeuble+"]["+(d-1)+"]",g);a.form["delete"]("etage_image["+a.indiceImmeuble+"]["+d+"]")}}};a.valider=function(){f.close()};a.cancel=function(){f.dismiss("cancel")};a.duplique=function(b){var c=a.immeuble.etages.length,d=a.immeuble.etages.indexOf(b);a.immeuble.etages[c]=JSON.parse(JSON.stringify(b));a.immeuble.etages[c].numero=a.numero;a.numero++;immeubleApp.apply(a,
l);var g=a.form.get("etage_image["+a.indiceImmeuble+"]["+d+"]");a.form.set("etage_image["+a.indiceImmeuble+"]["+c+"]",g);for(g=0;g<b.appartements.length;g++){var f=a.form.get("appartement_planVente["+a.indiceImmeuble+"]["+d+"]["+g+"]"),h=a.form.get("appartement_vv["+a.indiceImmeuble+"]["+d+"]["+g+"]");a.form.set("appartement_planVente["+a.indiceImmeuble+"]["+c+"]["+g+"]",f);a.form.set("appartement_vv["+a.indiceImmeuble+"]["+c+"]["+g+"]",h)}}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("gererProjet",function(a,l,k,h,f,d,c){function g(){h.getProjet(f.id,function(b){a.projet=b;a.nomProjet=b.nom;immeubleApp.apply(a,k)},!0)}a.isModifier=!0;a.init=function(){a.isModifier=!1;a.projet={immeubles:[],imageDiaporamas:[],color:"#009aff"};immeubleApp.apply(a,k)};a.form=new FormData;a.isModifier&&void 0!==f.id&&g();a.openDrawPolygoneImmeuble=function(b){var c=void 0!==a.projet.image?a.projet.image:"/static/projets/complet/"+a.projet.nom+a.projet.imageURL;d.open({animation:!0,
templateUrl:"/static/framework/template/drawDialog.html",controller:"draw",size:"lg",resolve:{image:function(){return c},obj:function(){return b},autreObjs:function(){return a.projet.immeubles}}}).result.then(function(a){b.points_polygone=a},function(){})};$("#colorProjet input[type=file]").change(function(){immeubleApp.openDialog("#choisirColor-dialog");var a=$("#choisirColor-dialog");a.css("width",$(window).width()+"px");a.css("height",$(window).height()-20+"px")});a.choisirColor=function(b){var c=
b.offsetX;b=b.offsetY;var d=document.createElement("canvas"),g=d.getContext("2d"),f=$("#imageChoisirColor").width(),h=$("#imageChoisirColor").height();d.width=f;d.height=h;d=new Image(f,h);d.src=a.projet.imageColorURL;g.drawImage(d,0,0,f,h);f=g.getImageData(c,b,1,1).data;c=a.projet;b=f[0];g=f[1];f=f[2];if(255<b||255<g||255<f)throw"Invalid color component";b=(b<<16|g<<8|f).toString(16);c.color="#"+b;immeubleApp.closeDialog()};a.closeDialog=function(){immeubleApp.closeDialog()};a.closeImmeubleFenetre=
function(){immeubleApp.closeModalDialog();a.immeubleChoisir=null};a.choisirImmeuble=function(b){if(b.avoirEtageComposition)d.open({animation:!0,templateUrl:"/static/framework/template/gererEtages.html",controller:"gererEtages",size:"grand",resolve:{immeuble:function(){return b},form:function(){return a.form},indiceImmeuble:function(){return a.projet.immeubles.indexOf(b)},nomProjet:function(){return a.nomProjet}}});else{if(void 0!==b.appartements)var c=b.appartements.length,g=0===c?1:b.appartements[c-
1].numero+1;else g=1;d.open({animation:!0,templateUrl:"/static/framework/template/gererAppartements.html",controller:"gererAppartements",size:"grand",resolve:{numero:function(){return g},immeuble:function(){return b},form:function(){return a.form},etage:function(){return null},indiceImmeuble:function(){return a.projet.immeubles.indexOf(b)},indiceEtage:function(){return null},nomProjet:function(){return a.nomProjet}}})}};a.removeImmeuble=function(b){var e=a.projet.immeubles.indexOf(b);if(void 0!==
b.id)c.removeImmeuble(a.projet.id,b.id,function(){a.projet.immeubles.splice(e,1);immeubleApp.apply(a,k)});else{b=a.projet.immeubles.length;a.form["delete"]("immeuble["+e+"]");a.projet.immeubles.splice(e,1);for(var d=e+1;d<b;d++){var g=a.form.get("immeuble["+d+"]");a.form.set("immeuble["+(d-1)+"]",g);a.form["delete"]("immeuble["+d+"]")}}};a.ajouterImmeubleButtonHandler=function(){a.projet.immeubles[a.projet.immeubles.length]={nom:"",avoirEtageComposition:!1,imageURL:"",points_polygone:""};immeubleApp.apply(a,
k)};a.verifierFormulaireAjout=function(b,c){void 0!==a.projet.nom&&a.projet.nom.match("^[a-zA-Z1-9 ]{2,100}$")?(jQuery($('[ng-model="projet.nom"]').removeClass("input-invalid")),a.isModifier?a.nomProjet!==a.projet.nom?h.isProjetExist(a.projet.nom,function(){jQuery($('[ng-model="projet.nom"]').addClass("input-invalid"));c()},function(){jQuery($('[ng-model="projet.nom"]').removeClass("input-invalid"));b()},function(){immeubleApp.openErrorConnexionDialog(d);c()}):b():h.isProjetExist(a.projet.nom,function(){jQuery($('[ng-model="projet.nom"]').addClass("input-invalid"));
c()},function(){jQuery($('[ng-model="projet.nom"]').removeClass("input-invalid"));b()},function(){immeubleApp.openErrorConnexionDialog(d);c()})):(jQuery($('[ng-model="projet.nom"]').addClass("input-invalid")),c())};a.isEncours=!1;a.ajouterProjet=function(){var b=$("#progressbar");h.addProjet(a.projet,a.form,function(b){immeubleApp.openInformationDialog(d,"Le Projet a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e9s",function(){d.open({animation:!0,templateUrl:"/static/framework/template/informationPromoteur.html",
controller:"informationPromoteur"}).result.then(function(b){h.donneAcces(a.projet.nom,b.nom,function(){immeubleApp.openInformationDialog(d,"Le promoteur "+b.nom+" a maintenant le droit d'acc\u00e8s au projet "+a.projet.nom,function(){void 0!==b.email&&""!==b.email?immeubleApp.openWarningDialog(d,"Envoyer Email au promoteur",function(){h.envoyerEmail(a.projet.nom,b.nom,b.email,function(){location.reload()},function(){immeubleApp.openErrorConnexionDialog(d);location.reload()})},function(){location.reload()}):
location.reload()})},function(){immeubleApp.openErrorConnexionDialog(d)})},function(){location.reload()})});a.isEncours=!1},function(){immeubleApp.openErrorConnexionDialog(d);a.isEncours=!1},function(a){b.css("width",a+"%")})};a.modifierProjet=function(){var b=$("#progressbar");h.modifierProjet(a.projet,a.form,function(){immeubleApp.openInformationDialog(d,"Le Projet a \u00e9t\u00e9 modifi\u00e9 avec succ\u00e9s");a.isEncours=!1;setTimeout(function(){location.reload()},2E3)},function(){immeubleApp.openErrorConnexionDialog(d);
a.isEncours=!1},function(a){b.css("width",a+"%")})};a.valider=function(){a.isEncours||(a.isEncours=!0,a.verifierFormulaireAjout(function(){a.isModifier?a.modifierProjet():a.ajouterProjet()},function(){a.isEncours=!1}))};$("myfile[form=projet_diaporamas] input[type=file]").change(function(){h.removeProjetAllDiaporama(a.projet.id,function(){a.projet.diaporamas=[];immeubleApp.apply(a,k)})});$(".AddImageDiapo button").click(function(){$(".AddImageDiapo input[type=file]").click()});a.addImageDiapo=function(b){b=
b.files;for(var c=a.form.get("projet_diaporamasNB"),c=null===c?0:parseInt(c),d=0;d<b.length;d++)a.form.set("projet_diaporamas["+(d+c)+"]",b[d]),a.projet.imageDiaporamas[d+c]=immeubleApp.createURL(b[d]);a.form.set("projet_diaporamasNB",c+b.length);immeubleApp.apply(a,k)};a.removeDiaporama=function(b){h.removeProjetDiaporama(a.projet.id,b,function(){var c=a.projet.diaporamas.indexOf(b);a.projet.diaporamas.splice(c,1);immeubleApp.apply(a,k)})};a.removeImageDiaporama=function(b){var c=a.projet.imageDiaporamas.length,
d=a.form;d.get("projet_diaporamasNB");-1<b&&a.projet.imageDiaporamas.splice(b,1);d["delete"]("projet_diaporamas["+b+"]");for(b+=1;b<c;b++){var g=d.get("projet_diaporamas["+b+"]");d.set("projet_diaporamas["+(b-1)+"]",g);d["delete"]("projet_diaporamas["+b+"]")}d.set("projet_diaporamasNB",c-1);immeubleApp.apply(a,k)}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("gererProjetPromoteur",function(a,l,k,h,f){a.init=function(d){h.getProjet(d,function(c){a.projet=c;immeubleApp.apply(a,k)},!0)};a.valider=function(){for(var d=[],c=0;c<a.projet.immeubles.length;c++)if(a.projet.immeubles[c].avoirEtageComposition)for(var g=0;g<a.projet.immeubles[c].etages.length;g++)d=d.concat(a.projet.immeubles[c].etages[g].appartements);else d=d.concat(a.projet.immeubles[c].appartements);immeubleApp.openWarningDialog(f,"\u00eates-vous s\u00fbre d'enregistrer ces modifications",
function(){h.modifierAppartements(d,function(){immeubleApp.openInformationDialog(f,"Les modifications sont enregistr\u00e9es",function(){location.reload()})},function(){immeubleApp.openErrorConnexionDialog(f)})},function(){})}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("home",function(a,l,k,h){a.projet={imageURL:"/static/framework/images/wait.gif"};h.getProjet(null,function(f){a.projet=f;k(function(){a.$apply()},1)});jQuery(function(){$("img").load(function(){null===localStorage.getItem("newClient")?(localStorage.setItem("newClient",!0),$("#svg polygon").addClass("polygone-polygon"),$("#reminder").css("display","block"),setTimeout(function(){$(".polygone-polygon").removeClass("polygone-polygon");$("#reminder").css("display","none")},3E3)):
($("#svg polygon").addClass("polygone-polygon"),setTimeout(function(){$(".polygone-polygon").removeClass("polygone-polygon")},1E3))})});a.hover=function(a,d){immeubleApp.openDescriptionDialog(a,d.pageX-50,d.pageY+15)};a.mouseoverTdHandler=function(a){$("svg polygon#"+a).addClass("polygone-polygon")};a.mouseoutTdHandler=function(a){$("svg polygon#"+a).removeClass("polygone-polygon")};a.out=function(){immeubleApp.closeDescriptionDialog()};a.goToImmeuble=function(f){a.go("immeuble/"+f)};a.go=function(f){a.out();
$(".zoom").fadeOut();immeubleApp.go(l,k,f)};a.showTable=!1;a.topButtonHandler=function(){a.showTable=!a.showTable}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("ImageGalleryController",function(a,l,k,h){function f(){return setInterval(function(){a.droite()},4E3)}a.images=[];a.isEncours=!1;jQuery(function(){a.interval=f()});a.droite=function(){if(!a.isEncours){a.isEncours=!0;var d=$(".fenetreDimension").css("width").replace("px",""),d=parseInt(d),c=$("div#imagesAffichage ul li:first-child"),g=$("div#imagesAffichage ul");$(g).animate({left:"-"+d},2E3,function(){$(g).append(c);$(g).css("left","0px");a.isEncours=!1})}};a.gauche=function(){if(!a.isEncours){a.isEncours=
!0;clearInterval(a.interval);var d=$(".fenetreDimension").css("width").replace("px",""),d=parseInt(d);clearInterval(a.interval);var c=$("div#imagesAffichage ul li:last-child"),g=$("div#imagesAffichage ul");$(g).prepend(c);$(g).css("left","-"+d+"px");$(g).animate({left:"0px"},2E3,function(){a.isEncours=!1;a.interval=f()})}};a.getImagesPanorama=function(){if(0==a.images.length)h.getProjet(null,function(d){a.images=d.diaporamas;k(function(){a.$apply();immeubleApp.adjestWidthHeightFenetreHandler()},1)});
else return a.images}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("immeuble",function(a,l,k,h,f,d){a.immeuble={id:f.id};d.getImmeuble(a.immeuble.id,function(c){a.immeuble=c;immeubleApp.apply(a,k)});a.openDescriptionApp=function(a,d,b){var e=$("#descriptionAppartementDialog");$(e).find(".numeroApp").html(a.numero);$(e).find(".nbChambreApp").html(a.nbChambre);$(e).find(".etageApp").html(a.etage);$(e).find(".superficieApp").html(h("number")(a.superficie,0)+" m\u00b2");$(e).find(".prixApp").html(h("number")(a.prix,2)+" DH");$(e).find(".disponibleApp").html(a.disponibilite);
$(e).find(".disponibleApp").removeClass("r\u00e9serv\u00e9e");$(e).find(".disponibleApp").removeClass("vendu");$(e).find(".disponibleApp").removeClass("disponible");$(e).find(".disponibleApp").removeClass("non");$(e).find(".disponibleApp").addClass(a.disponibilite);a=parseFloat($(".fenetreDimension").css("height").replace("px",""));var f=$(e).height();b+f>a&&(b=b-f-30);$(e).css("top",b+"px");$(e).css("left",d+"px");$(e).css("display","block")};a.closeDescriptionApp=function(){var a=$("#descriptionAppartementDialog");
$(a).css("display","none")};a.getAppartement=function(c){for(var d=a.immeuble.appartements,b=0;b<d.length;b++)if(d[b].id===c)return d[b]};jQuery(function(){$("img").load(function(){null===localStorage.getItem("newClient")?(localStorage.setItem("newClient",!0),$("#svg polygon").addClass("polygone-polygon"),$("#reminder").css("display","block"),setTimeout(function(){$(".polygone-polygon").removeClass("polygone-polygon");$("#reminder").css("display","none")},3E3)):($("#svg polygon").addClass("polygone-polygon"),
setTimeout(function(){$(".polygone-polygon").removeClass("polygone-polygon")},1E3))})});a.isReservee=function(a){return"r\u00e9serv\u00e9e"===a.disponibilite};a.hover=function(c,d){a.openDescriptionApp(a.getAppartement(c),d.pageX-50,d.pageY+15)};a.hoverEtage=function(a){immeubleApp.openDescriptionDialog(a.numero,event.pageX-50,event.pageY+15)};a.outEtage=function(){immeubleApp.closeDescriptionDialog()};a.mouseoverTdHandler=function(a){$("svg polygon#"+a).addClass("polygone-polygon")};a.mouseoutTdHandler=
function(a){$("svg polygon#"+a).removeClass("polygone-polygon")};a.out=function(){a.closeDescriptionApp()};a.goToAppartement=function(c){a.go("appartement/"+c)};a.goToEtage=function(c){a.go("etage/"+c)};a.go=function(c){a.out();a.outEtage();immeubleApp.go(l,k,c)};a.showTable=!1;a.topButtonHandler=function(){a.showTable=!a.showTable}});immeubleApp=angular.module("immeubleApp");immeubleApp.controller("informationPromoteur",function(a,l){a.promoteur={};a.error=[];a.ok=function(){void 0!==a.promoteur.nom&&a.promoteur.nom.match("^[a-zA-Z1-9 ]{2,100}$")?(a.error[0]=!1,l.close(a.promoteur)):a.error[0]=!0};a.cancel=function(){l.dismiss("cancel")}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("ListerProjet",function(a,l,k,h,f,d){function c(){d.getProjets(h.page,function(c){a.projets=c;l(function(){a.$apply()},1)})}a.projets=[];a.projetRechercher="";a.getURL=function(a){return k.protocol()+"://"+k.host()+immeubleApp.urlProjet+a.id};a.previous=function(){if(1!==parseInt(h.page)){var a=parseInt(h.page)-1;l(function(){k.path("/lister/"+a)},1)}};a.next=function(){var a=parseInt(h.page)+1;l(function(){k.path("/lister/"+a)},1)};a.$watch("projetRechercher",function(g){""===
g?c():d.rechercherProjets(g,function(b){a.projets=b;l(function(){a.$apply()},1)})});c();a.imprimer=function(a){var b=document.createElement("form");b.setAttribute("method","post");b.setAttribute("action","/imprimerprojet");b.setAttribute("target","_blank");var c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name","id");c.setAttribute("value",a.id);b.appendChild(c);document.body.appendChild(b);b.submit()};a.modifier=function(a){l(function(){k.path("/modifier/"+a.id)},
1)};a.envoyerEmail=function(){f.open({animation:!0,templateUrl:"/static/framework/template/envoyerEmail.html",controller:"informationPromoteur"}).result.then(function(a){d.donneAcces(a.nomProjet,a.nom,function(){immeubleApp.openInformationDialog(f,"Le promoteur "+a.nom+" a maintenant le droit d'acc\u00e8s au projet "+a.nomProjet,function(){d.envoyerEmail(a.nomProjet,a.nom,a.email,function(){},function(){immeubleApp.openErrorConnexionDialog(f)})})},function(){immeubleApp.openErrorConnexionDialog(f)})},
function(){})};a.dupliquer=function(g){d.dupliquerProjet(g.id,function(){var b=g.nom+"-interne";immeubleApp.openInformationDialog(f,"Le Projet a \u00e9t\u00e9 dupliqu\u00e9 avec succ\u00e9s",function(){f.open({animation:!0,templateUrl:"/static/framework/template/informationPromoteur.html",controller:"informationPromoteur"}).result.then(function(c){d.donneAcces(b,c.nom,function(){immeubleApp.openInformationDialog(f,"Le promoteur "+c.nom+" a maintenant le droit d'acc\u00e8s au projet "+a.projet.nom,
function(){void 0!==c.email&&""!==c.email&&immeubleApp.openWarningDialog(f,"Envoyer Email au promoteur",function(){d.envoyerEmail(b,c.nom,c.email,function(){},function(){immeubleApp.openErrorConnexionDialog(f)})},function(){})})},function(){immeubleApp.openErrorConnexionDialog(f)})},function(){})});c()},function(){immeubleApp.openErrorDialog("erreur lors de connection veuillez v\u00e9rifier votre connection","erreur de connection")})};a.remove=function(a){immeubleApp.openWarningDialog(f,"\u00eates-vous s\u00fbre de supprimer le projet "+
a.nom,function(){d.removeProjet(a.id,function(){c()},function(){immeubleApp.openErrorDialog("erreur lors de connection veuillez v\u00e9rifier votre connection","erreur de connection")})},function(){})}});immeubleApp=angular.module("immeubleApp");
immeubleApp.controller("recherche",function(a,l,k,h,f){a.idProjet=null;a.appartements=[];a.condition={prix:{min:12E4,max:24E5},superficie:{min:60,max:400},nbChambre:{min:2,max:10}};a.choisir=function(a){k(function(){l.path("/appartement/"+a.id)},1)};h.getProjet(null,function(d){a.idProjet=d.id;f.getAppartementsProjet(a.idProjet,function(c){a.appartements=c;k(function(){a.$apply()},1)})});a.$watch("condition",function(d){null!==a.idProjet&&f.rechercheAppartements(a.idProjet,a.condition,function(c){a.appartements=
c;k(function(){a.$apply()},1)})},!0)});immeubleApp=angular.module("immeubleApp");immeubleApp.controller("simuler",function(a,l,k){a.parametreDuCredit={EchAnn:12,montant:1E4,duree:2,taux:15};a.mensualite=0;a.mensualiteEstCalcule=function(){return 0!==a.mensualite};a.$watch("parametreDuCredit",function(h){h=a.parametreDuCredit.taux/1200;a.mensualite=parseFloat(a.parametreDuCredit.montant*h/(1-Math.pow(1+h,-(a.parametreDuCredit.EchAnn*a.parametreDuCredit.duree))));k(function(){a.$apply()},1)},!0)});